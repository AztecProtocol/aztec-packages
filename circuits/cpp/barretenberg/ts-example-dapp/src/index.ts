import createDebug from "debug";
import { inflate } from "pako";

createDebug.enable("*");
const debug = createDebug("simple_test");

function base64ToUint8Array(base64: string) {
  let binaryString = atob(base64);
  let len = binaryString.length;
  let bytes = new Uint8Array(len);
  for (let i = 0; i < len; i++) {
    bytes[i] = binaryString.charCodeAt(i);
  }
  return bytes;
}

// This is the double_verify_proof test.
// It's used here as an example of a 512k gate test that hits a lot of the stack.
// Triggered via the button click.
const acir = inflate(
  base64ToUint8Array(
    "H4sIAAAAAAAA/+3YY4xkaRhA4e6xp8e2bavHtj2ztjG2bdu2bWttjm3P9uyp9OnNZP/uJrOb9E2enNxblU5V3qrvVn8dg4OCYgaFH9HtB5aHgqIgKqL5eIyg8OfHQmzEQVzEQ3wkQEKEIBESIwmSIhmSIwVSIhVSIw3SIh3SIwMyIhMyIwuyIhuyIwdyIhdyIw/yIh/yowAKohAKowiKohiKowRKohRKowzKohzKowJCURGVUBlVUBXVUB01UBO1UBt1UBf1UB8N0BCN0BhN0BTN0Bwt0BKt0Bpt0Bbt0B4d0BEv4EW8hJfxCl7Fa3gdb+BNvIW38Q7exXt431lGd5btnOuH+Agf4xN8ik7ojC7oim7ojh7oiV7ojT7oi37ojwEYiEEYjCEYimEYjhEYiVEYjTEYi3EYjwmYiEmYjCmYimmYjhmYiVmYjTmYi3mYjwVYiEVYjCVYimVYjhVYiVVYjTVYi3VYjw3YiE3YjC3Yim3Yjh3YiV3YjT3Yi33YjwM4iEM4jCM4imM4jhM4iVPOIYqzCByfeS3w/Qrx2hf4El/ha3yDb/EdvscP+BE/4Wf8gl/xG3737wW+qxGzPo0zOItzOI8LuIhLuIwruIpruI4buIlbuI07uIt7uI8HeIhHeIwn+ANheBoU/gaDEQVREQ3RESOw1iAWYiMO4iIe4iMBEiIEiZAYSZAUyZAcKZASqZAaaZAW6ZAeGZARmZAZWZAV2ZAdOZATuZAbeZAX+ZAfBVAQhVAYRVAUxVAcJVASpVAaZVAW5VAeFRAaHD7jwHr47Foa5vzDnHmYswpzboHGsDFtLBvbxrFxbTwb3yawCW2ITWQT2yQ2qU1mk9sUNqVNZVPbNDatTWfT2ww2o81kM9ssNqvNZrPbHDanzWVz2zw2r81n89sCtqAtZAvbIraoLWaL2xK2pC1lS9sytqwtZ8vbCjbUVrSVbGVbxVa11Wx1W8PWtLVsbVvH1rX1bH3bwDa0jWxj28Q2tc1sc9vCtrStbGvbxra17Wx728F2tC/YF+1L9mX7in3VvmZft2/YN+1b9m37jn3Xvmfftx888zoDx4eef2Q/tp/YT20n29l2sV1tN9vd9rA9bS/b2/axfW0/298OsAPtIDvYDrFD7TA73I6wI+0oO9qOsWPtODveTrAT7SQ72U6xU+00O93OsDPtLDvbzrFz7Tw73y6wC+0iu9gusUvtMrvcrrAr7Sq72q6xa+06u95usBvtJrvZbrFb7Ta73e6wO+0uu9vusXvtPrvfHrAH7SF72B6xR+0xe9yesCftKfvsb4/A+ef2rx8gFXlGJVRGFVRFNVRHDdRELdRGHdRFPdRHg8gbX+SNz4bayBtfeP9rN77Tnp+xZ+05e95esBftJXvZXrFX7TV73d6wN+0te9vesXftPXvfPrAP7SP72D6xEf+ARHhqAwtQoME2io1qo9noNoaNaWPZ2DaOjWvj2fg2gU1oQ2wim9gmsUltMpvcprApbSqb2qaxaW06m95msBltJpvZZrFZbTab3eawOW0um9vmsXltPpvfFrAFbSFb2BaxRW0xW9yWsCVtKVvalrFlbTlb3lawoRHzDwo//n7jC372xhe4UMlWtlVsVVvNVrc1bE1by9a2dWxdW8/Wtw0iPii+joacN0JjNEFTNENztEBLtEJrtEFbtEN7dAgOf8N+7iN374L+/7t3kbt1z2e3LrBQBBaJf7ojF7kD93x24CKOf2td/ROKWJ6DKhkAAA=="
  )
);
const witness = inflate(
  base64ToUint8Array(
    "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"
  )
);

async function runTest(
  bytecode: Uint8Array,
  witness: Uint8Array,
  threads?: number
) {
  const { Barretenberg, RawBuffer, Crs } = await import("@aztec/bb.js");
  const CIRCUIT_SIZE = 2 ** 19;

  debug("starting test...");
  const api = await Barretenberg.new(threads);

  // Important to init slab allocator as first thing, to ensure maximum memory efficiency.
  await api.commonInitSlabAllocator(CIRCUIT_SIZE);

  // Plus 1 needed!
  const crs = await Crs.new(CIRCUIT_SIZE + 1);
  await api.srsInitSrs(
    new RawBuffer(crs.getG1Data()),
    crs.numPoints,
    new RawBuffer(crs.getG2Data())
  );

  const acirComposer = await api.acirNewAcirComposer(CIRCUIT_SIZE);
  const proof = await api.acirCreateProof(
    acirComposer,
    bytecode,
    witness,
    true
  );
  debug(`verifying...`);
  const verified = await api.acirVerifyProof(acirComposer, proof, true);
  debug(`verified: ${verified}`);

  await api.destroy();

  debug("test complete.");
  return verified;
}

document.addEventListener("DOMContentLoaded", function () {
  const button = document.createElement("button");
  button.innerText = "Run Test";
  button.addEventListener("click", () => runTest(acir, witness));
  document.body.appendChild(button);
});
