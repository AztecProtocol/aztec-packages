use dep::aztec::macros::aztec;

#[aztec]
contract AuthWitTest {
    use dep::aztec::{protocol_types::address::AztecAddress, macros::{functions::{private, public}}};

    use dep::authwit::auth::{assert_inner_hash_valid_authwit, assert_inner_hash_valid_authwit_public};

    #[private]
    #['private]
    fn consume(on_behalf_of: AztecAddress, inner_hash: Field) {
        assert_inner_hash_valid_authwit(&mut context, on_behalf_of, inner_hash);
    }

    #[public]
    #['public]
    fn consume_public(on_behalf_of: AztecAddress, inner_hash: Field) {
        assert_inner_hash_valid_authwit_public(&mut context, on_behalf_of, inner_hash);
    }
}
