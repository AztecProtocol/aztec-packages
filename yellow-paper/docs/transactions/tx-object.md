# Transaction object

The transaction object is the struct broadcasted to the p2p network, generated by [_local execution_](./local-execution.md) by the user's PXE. Sequencers pick up transactions from the p2p network to include in a block.

## Transaction object struct

The fields of a transaction object are the following:

| Field | Type | Description |
|----------|----------|----------|
| data        | PrivateKernelPublicInputsFinal    | Public inputs (ie output) of the last iteration of the private kernel circuit for this transaction.  |
| proof  | Buffer | Zero-knowledge honk proof for the last iteration of the private kernel circuit for this transaction. |
| encryptedLogs      | Buffer[][]    | Encrypted logs emitted per function in this transaction. Position `i` contains the encrypted logs emitted by the `i`-th function execution.  |
| unencryptedLogs     | Buffer[][]    | Equivalent to the above but for unencrypted logs.  |
| enqueuedPublicFunctionCalls | PublicCallRequest[]    | List of public function calls to run during public execution. |
| newContracts   | ExtendedContractData[]    | List of new contracts to be deployed as part of this transaction. |

### Private kernel public inputs final

Output of the last iteration of the private kernel circuit. Includes _accumulated data_ after recursing through all private function calls, as well as _constant data_ composed of _historic block data_ reflecting the state of the chain when such functions were executed, and the global _transaction context_. Refer to the circuits section for more info.

**Accumulated data**

| Field | Type | Description |
|-------|------|-------------|
| aggregationObject | AggregationObject | Aggregated proof of all the previous kernel iterations. |
| newCommitments | Field[] | The new commitments made in this transaction. |
| newNullifiers | Field[] | The new nullifiers made in this transaction. |
| nullifiedCommitments | Field[] | The commitments which are nullified by a nullifier in the above list. |
| privateCallStack | Field[] | Current private call stack. |
| publicCallStack | Field[] | Current public call stack. |
| newL2ToL1Msgs | Field[] | All the new L2 to L1 messages created in this transaction. |
| encryptedLogsHash | Field[] | Accumulated encrypted logs hash from all the previous kernel iterations. |
| unencryptedLogsHash | Field[] | Accumulated unencrypted logs hash from all the previous kernel iterations. |
| encryptedLogPreimagesLength | Field | Total accumulated length of the encrypted log preimages emitted in all the previous kernel iterations. |
| unencryptedLogPreimagesLength | Field | Total accumulated length of the unencrypted log preimages emitted in all the previous kernel iterations. |
| newContracts | NewContractData[] | All the new contracts deployed in this transaction. |

**Historic block data**

| Field | Type | Description |
|-------|------|-------------|
| noteHashTreeRoot | Field | Root of the note hash tree at the time of when this information was assembled. |
| nullifierTreeRoot | Field | Root of the nullifier tree at the time of when this information was assembled. |
| contractTreeRoot | Field | Root of the contract tree at the time of when this information was assembled. |
| l1ToL2MessagesTreeRoot | Field | Root of the L1 to L2 messages tree at the time of when this information was assembled. |
| blocksTreeRoot | Field | Root of the historic blocks tree at the time of when this information was assembled. |
| privateKernelVkTreeRoot | Field | Root of the private kernel VK tree at the time of when this information was assembled (future enhancement). |
| publicDataTreeRoot | Field | Current public state tree hash. |
| globalVariablesHash | Field | Previous globals hash, this value is used to recalculate the block hash. |

### Public call request

Each _public call request_ is the preimage of a public call stack item in the transaction's `data`, and has the following fields:

| Field | Type | Description |
|----------|----------|----------|
| contractAddress        | AztecAddress    | Address of the contract on which the function is invoked.  |
| callContext  | CallContext | Includes function selector and caller. |
| args      | Field[]    | Arguments to the function call.  |
| sideEffectCounter | number? | Optional counter for ordering side effects of this function call. |

### Extended contract data

Each _extended contract data_ corresponds to a contract being deployed by the transaction, and has the following fields:

| Field | Type | Description |
|----------|----------|----------|
| address        | AztecAddress    | Address where the contract is to be deployed.  |
| portalAddress  | EthereumAddress | Portal address on L1 for this contract (zero if none). |
| bytecode | Buffer | Encoded Brillig bytecode for all public functions in the contract. |
| publicKey | PublicKey | Master public encryption key for this contract (zero if none). |
| partialAddress | Field | Hash of the constructor arguments, salt, and bytecode. |

## Transaction hash

A transaction is identified by its _transaction hash_. In order to be able to identify a transaction before it has been locally executed, the hash is computed from its [_transaction execution request_](./local-execution.md#execution-request) by hashing:

- `origin`
- `functionSelector`
- `argsHash`
- `txContent`

The resulting transaction hash is always emitted during local execution as the first nullifier of the transaction, in order to prevent replay attacks. This is enforced by the private kernel circuit.