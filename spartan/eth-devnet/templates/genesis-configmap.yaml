{{/*
Validate that required genesis files exist
*/}}
{{- $basePath := .Values.ethereum.genesisBasePath }}
{{- $requiredFiles := list "config.yaml" "deposit_contract_block.txt" "genesis-ssz" "genesis.json" "chainspec.json" }}
{{- range $requiredFiles }}
  {{- $filePath := printf "%s/%s" $basePath . }}
  {{- if not ($.Files.Get $filePath) }}
    {{- fail (printf "ERROR: Required genesis file '%s' not found. Please run './create_genesis.sh' first to generate genesis files." $filePath) }}
  {{- end }}
{{- end }}

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "eth-devnet.fullname" . }}-eth-beacon-genesis
  labels:
    {{- include "eth-devnet.labels" . | nindent 4 }}
data:
  {{- $basePath := .Values.ethereum.genesisBasePath }}
  config.yaml: |
    {{- $path := printf "%s/config.yaml" $basePath }}
    {{ .Files.Get $path | nindent 4 }}
  deposit_contract_block.txt: |
    {{- $path := printf "%s/deposit_contract_block.txt" $basePath }}
    {{ .Files.Get $path | nindent 4 }}
  jwt-secret.hex: "0x61e1dd9539e8cc37b3d71dcf8ce372f0e119cc1c73426ee80472a4214f2a41a1"
  genesis-ssz: |
    {{- $path := printf "%s/genesis-ssz" $basePath }}
    {{ .Files.Get $path | nindent 4 }}

---
apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ include "eth-devnet.fullname" . }}-eth-execution-genesis
  labels:
    {{- include "eth-devnet.labels" . | nindent 4 }}
data:
  {{- $basePath := .Values.ethereum.genesisBasePath }}
  genesis.json: |
    {{- $path := printf "%s/genesis.json" $basePath }}
    {{ .Files.Get $path | nindent 4 }}
  chainspec.json: |
    {{- $path := printf "%s/chainspec.json" $basePath }}
    {{ .Files.Get $path | nindent 4 }}
  jwt-secret.hex: "0x61e1dd9539e8cc37b3d71dcf8ce372f0e119cc1c73426ee80472a4214f2a41a1"
